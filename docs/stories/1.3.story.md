---
epic: 1
story-id: 3
title: "Settings Page Foundation"
status: "Draft"
---

### 1. Story

As a logged-in user, I want to navigate to a "Settings" page, so that I can manage my Firefly III API connection.

### 2. Acceptance Criteria

1.  A "Settings" link or button is present in the main application navigation (e.g., the App Bar).
2.  Clicking the "Settings" link navigates the user to a new `/settings` page.
3.  The settings page displays a clear heading, such as "Settings".
4.  The settings page contains a section or form for "Firefly III Connection" with placeholder UI elements for the URL and Personal Access Token.

### 3. Dev Notes

#### Previous Story Insights
*   This story builds on the user being logged in (Story 1.2). It requires a protected route that only authenticated users can access.

#### Data Models
*   **`FireflyConnection`**: This story involves creating the UI for this model, but not the backend logic to save the data yet. The UI should be prepared to capture the `firefly_url`.
    *   `[Source: architecture.md#4.4 Model: FireflyConnection]`

#### API Specifications
*   No new backend API interactions are required for this story. This is purely a frontend routing and UI layout task.

#### Component Specifications
*   **App Bar**: The main navigation component needs to be updated to include a link or button to `/settings`.
    *   `[Source: front-end-spec.md#5.1 Core Components]`
*   **Settings Form**: A new form component should be created to house the Firefly III connection settings.
    *   It should include two `TextField` components from MUI for the URL and the token.
    *   It should include a `Button` for saving/testing the connection (the logic for the button click will be implemented in a future story).
    *   `[Source: front-end-spec.md#4.1 Key Screen Layouts]`

#### File Locations
*   **Frontend Page**: A new file should be created at `apps/web/src/app/settings/page.tsx`.
*   **Frontend Component**: The settings form could be a component at `apps/web/src/components/settings/FireflyConnectionForm.tsx`.
*   **Main Navigation**: The App Bar component, likely in `apps/web/src/components/layout/AppBar.tsx`, will need to be modified.

#### Testing Requirements
*   Unit tests should be created for the new `FireflyConnectionForm.tsx` component to ensure it renders correctly.
*   A navigation test should be added to verify that clicking the "Settings" link in the App Bar successfully routes the user to the `/settings` page.

### 4. Tasks / Subtasks

1.  **Create Settings Page Route (AC: 2, 3)**
    *   [ ] Create the settings page file at `apps/web/src/app/settings/page.tsx`.
    *   [ ] Add a basic page structure with a main heading (e.g., `<h1>Settings</h1>`).
2.  **Add Navigation Link (AC: 1)**
    *   [ ] Modify the main App Bar component.
    *   [ ] Add a button or link that uses Next.js's `<Link>` component to navigate to `/settings`.
3.  **Create Connection Form UI (AC: 4)**
    *   [ ] Create the `FireflyConnectionForm.tsx` component.
    *   [ ] Add two MUI `TextField` components, one for the "Firefly III URL" and one for the "Personal Access Token". The token field should be of `type="password"`.
    *   [ ] Add a MUI `Button` with the text "Save & Test Connection".
    *   [ ] Import and render this form on the settings page.
4.  **Implement Protected Route (AC: 1, 2)**
    *   [ ] Ensure that the `/settings` route is protected and only accessible to authenticated users. Unauthenticated users should be redirected to the `/login` page. (This may involve creating or modifying a middleware or a higher-order component).
5.  **Write Unit Tests (AC: 1, 2, 3, 4)**
    *   [ ] Create test files for the new components.
    *   [ ] Write a test to verify the settings form renders with the correct fields.
    *   [ ] Write a test to verify the navigation link to the settings page works.

### 5. QA Results
*   *Pending*
