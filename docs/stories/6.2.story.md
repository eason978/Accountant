---
epic: 6
story-id: 2
title: "(Technical Task) Set Up Database Schema"
status: "Draft"
---

### 1. Goal

To create the initial database tables, indexes, and relationships in the Supabase PostgreSQL database, ensuring the data layer is ready for the application logic.

### 2. Acceptance Criteria

1.  An SQL script is created containing the `CREATE TABLE` statements for `profiles`, `firefly_connections`, `import_jobs`, `staged_transactions`, and `mapping_rules`.
2.  The script accurately reflects the columns, data types, primary keys, foreign keys, and indexes defined in the `architecture.md` document.
3.  The script is runnable and can be successfully applied to the Supabase project's database via the SQL Editor.
4.  Row Level Security (RLS) is noted as needing to be enabled for all tables after creation.

### 3. Dev Notes

#### Technical Context
*   The single source of truth for this task is the `9. Database Schema` section of the `architecture.md` document.
*   The developer should copy the SQL from the architecture document and save it into a script file for version control and easy execution.

#### File Locations
*   A new SQL file should be created, for example: `supabase/migrations/001_initial_schema.sql`.

### 4. Tasks / Subtasks

1.  **Create SQL Script File (AC: 1)**
    *   [ ] Create a new directory `supabase/migrations` to store database scripts.
    *   [ ] Create a new file named `001_initial_schema.sql` inside it.
2.  **Copy Schema from Architecture Doc (AC: 2)**
    *   [ ] Copy the exact `CREATE TABLE` statements from the `architecture.md` section 9.
    *   [ ] Paste the statements into the new SQL script file.
3.  **Review and Verify Script (AC: 2)**
    *   [ ] Manually review the script to ensure it matches the architecture document perfectly.
4.  **Apply Schema to Supabase (AC: 3, 4)**
    *   [ ] Navigate to the Supabase project's SQL Editor.
    *   [ ] Paste and run the content of the SQL script.
    *   [ ] After the tables are created, manually enable Row Level Security (RLS) for each new table in the Supabase dashboard.

### 5. QA Results
*   *Pending*
