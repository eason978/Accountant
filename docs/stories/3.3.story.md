---
epic: 3
story-id: 3
title: "Add UI Fields for Transaction Mapping"
status: "Draft"
---

### 1. Story

As a user, I want to see dropdowns for each transaction to map it to my Firefly III source account, destination account, and category, so that I know where to perform the mapping.

### 2. Acceptance Criteria

1.  The `TransactionTable` component is updated to include three new columns: "Source Account", "Destination Account", and "Category".
2.  Each cell within these new columns for each transaction row contains a dropdown/select input component.
3.  For this story, the dropdowns can be disabled or contain no options. The logic to populate them will be handled in the next story.
4.  The `user_mappings` field in the `StagedTransaction` model is the target for storing the selected values from these dropdowns in the future.

### 3. Dev Notes

#### Previous Story Insights
*   This story adds new columns to the editable grid from Story 3.2. It focuses purely on the UI layout changes.

#### Data Models
*   **`StagedTransaction`**: The `user_mappings` JSONB field will eventually store the data from these new UI elements. This story prepares the UI for that.
    *   `[Source: architecture.md#4.3 Model: StagedTransaction]`

#### API Specifications
*   No new backend APIs are required for this story. This is a frontend-only task.

#### Component Specifications
*   **TransactionTable**: The MUI Data Grid will be modified.
    *   Three new column definitions will be added.
    *   The `renderCell` or `renderEditCell` property of the column definitions will be used to render a MUI `Select` component in each cell of these new columns.
    *   `[Source: front-end-spec.md#5.1 Core Components]`

#### File Locations
*   **Frontend Component**: `apps/web/src/components/review/TransactionTable.tsx` will be the primary file to be modified.

#### Testing Requirements
*   **Frontend (Jest/RTL)**:
    *   Update tests for `TransactionTable.tsx`.
    *   Verify that the three new columns for mapping are rendered correctly.
    *   Verify that each row in these columns contains a select/dropdown component.

### 4. Tasks / Subtasks

1.  **Frontend: Add New Columns to Grid (AC: 1, 2)**
    *   [ ] In `TransactionTable.tsx`, modify the column definitions for the MUI Data Grid.
    *   [ ] Add new column definitions for `source_account_id`, `destination_account_id`, and `category_id`.
    *   [ ] Use the column's `renderCell` property to render a disabled MUI `Select` component as a placeholder in each cell for these columns.
2.  **Frontend: Update Data Structure (AC: 4)**
    *   [ ] Ensure the frontend data model for the transaction rows includes the `user_mappings` object to hold the future state of these dropdowns.
3.  **Write Tests (AC: 1, 2)**
    *   [ ] Update the Jest/RTL tests for `TransactionTable.tsx` to assert that the new columns and their select components are present in the rendered grid.

### 5. QA Results
*   *Pending*
