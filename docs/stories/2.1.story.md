---
epic: 2
story-id: 1
title: "Dashboard and File Upload Area"
status: "Draft"
---

### 1. Story

As a user, I want to see a dashboard with a clear file upload area, so that I can start a new import job.

### 2. Acceptance Criteria

1.  After logging in, the user is directed to the main dashboard page (`/`).
2.  The dashboard displays a prominent file upload component.
3.  The upload component clearly states the supported file types (PDF, JPG, PNG).
4.  The upload component supports both drag-and-drop and click-to-select file functionality.
5.  The dashboard displays a list or table of recent import jobs, showing at least the file name and its status (e.g., "Completed", "Processing", "Failed").
6.  If there are no recent jobs, a message indicating this is shown.

### 3. Dev Notes

#### Previous Story Insights
*   This is the first story of Epic 2. It assumes the user is authenticated as per Epic 1.

#### Data Models
*   **`ImportJob`**: The dashboard will display a list of these jobs. The frontend will need to fetch `ImportJob` records associated with the current user.
    *   `[Source: architecture.md#4.2 Model: ImportJob]`

#### API Specifications
*   To display recent jobs (AC: 5), a new backend endpoint will be needed:
    *   **`GET /api/v1/import-jobs`**: This endpoint should fetch all `ImportJob` records for the currently authenticated user from the database and return them.
    *   The backend logic should be secured so a user can only fetch their own jobs.
    *   `[Source: architecture.md#5.1 REST API Specification (OpenAPI)]`

#### Component Specifications
*   **File Upload Zone**: A new, dedicated component for handling file uploads.
    *   This component will manage its own state for drag-over effects.
    *   It should use a library like `react-dropzone` or a custom implementation to handle file selection.
    *   `[Source: front-end-spec.md#5.1 Core Components]`
*   **Import Jobs List**: A new component to display a list of jobs.
    *   This could be a MUI `Table` or `List` component.
    *   It will fetch data from the new `GET /import-jobs` endpoint.
    *   Each item should display the file name and a status badge with a color corresponding to the status (e.g., green for `completed`, red for `failed`).
    *   `[Source: front-end-spec.md#4.1 Key Screen Layouts]`

#### File Locations
*   **Frontend Page**: The main dashboard page, likely `apps/web/src/app/page.tsx`.
*   **Frontend Components**:
    *   `apps/web/src/components/upload/FileUploadZone.tsx`
    *   `apps/web/src/components/dashboard/ImportJobsList.tsx`
*   **Backend API Endpoint**: A new router for import jobs, e.g., `apps/api/routers/import_jobs.py`.

#### Testing Requirements
*   **Backend (Pytest)**:
    *   Write unit tests for the `GET /import-jobs` endpoint.
    *   Ensure the endpoint is properly secured and only returns jobs for the authenticated user.
*   **Frontend (Jest/RTL)**:
    *   Test the `FileUploadZone` component renders correctly.
    *   Test the `ImportJobsList` component, mocking the API call to test both a populated list and the empty state.

### 4. Tasks / Subtasks

1.  **Backend: Create API Endpoint (AC: 5)**
    *   [ ] In the FastAPI app, create a new router for `/import-jobs`.
    *   [ ] Implement the `GET /` endpoint.
    *   [ ] Add logic to fetch `ImportJob` records from Supabase for the `user_id` extracted from the JWT.
    *   [ ] Return the list of jobs.
2.  **Frontend: Create Upload Component (AC: 2, 3, 4)**
    *   [ ] Create the `FileUploadZone.tsx` component.
    *   [ ] Implement drag-and-drop and click-to-select functionality.
    *   [ ] Add clear text indicating supported file types.
3.  **Frontend: Create Jobs List Component (AC: 5, 6)**
    *   [ ] Create the `ImportJobsList.tsx` component.
    *   [ ] Use a library like `swr` or `react-query` to fetch data from `/api/v1/import-jobs`.
    *   [ ] Render the list of jobs in a table or list format.
    *   [ ] Implement the empty state view.
4.  **Frontend: Assemble Dashboard Page (AC: 1)**
    *   [ ] In `apps/web/src/app/page.tsx`, import and arrange the `FileUploadZone` and `ImportJobsList` components.
    *   [ ] Ensure the page is protected and requires authentication.
5.  **Write Tests**
    *   [ ] Implement backend unit tests for the new endpoint.
    *   [ ] Implement frontend unit tests for the new components.

### 5. QA Results
*   *Pending*
